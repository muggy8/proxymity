var proxymity=function(n){function t(n){return Array.prototype.slice.call(n||[])}function e(n,t){return n&&o(n.length)&&Array.prototype.forEach.call(n,t)}function r(n){return"function"==typeof n}function i(n){return"string"==typeof n}function o(n){return"number"==typeof n&&!isNaN(n)}function a(n){return Array.isArray(n)}function u(n,t){var e,r,i;return void 0===t||n>t?(r=n,e=t||0):(e=n,r=t),i=r-e,Math.round(Math.random()*(i+.9998)-.4999)+e}var c="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789_";function f(n){n=n||16;for(var t=c[u(51)],e=1;e<n;e++)t+=c[u(62)];return t}function l(n,t,e){return Object.defineProperty(n,t,{value:e}),e}function s(n,t,e,r){var i={get:e};return r&&(i.set=r),Object.defineProperty(n,t,i)}var d=function(){var n=f(u(32,48)),t=!1,r=[],i=0;function o(e){var o=Array.prototype.slice.call(arguments,1);t||(window.postMessage(n,"*"),t=!0,i++),r.some(function(n){return n.fn===e&&(n.args=o,!0)})||r.push({fn:e,args:o})}return window.addEventListener("message",function(a){if(a.data===n){a.stopPropagation();var c=r;n=f(u(32,48)),t=!1,r=[],i>10?console.warn("UI has been updated for 10 or more update loops. You might have a bug in your code that updated or watched to a already watched property. Execution of UI updates has automatically halted."):(e(c,function(n){n.args=n.args.map(function(n){return g(n)?n.get():n}),n.fn.apply(window,n.args)}),o.asyncEnd&&(o.asyncEnd(),delete o.asyncEnd,delete o.asyncEndPromise),!t&&o.renderEnd&&(o.renderEnd(),delete o.renderEnd,delete o.renderEndPromise),r.length||(i=0))}}),o}();function p(n,t){return Object.prototype.hasOwnProperty.call(n,t)}function h(t,r,i,o){o=o||function(){};var u=this||{},c=[];return e(function(n){n=n||"";var t=0,e=[],r=0;function i(){throw new Error("Potential Syntax Error within code: \n"+n)}function o(r,i){void 0===i&&(i=!0);var o=n.substring(t,r);if(!o)return t=r+1;i&&(o='"'+o+'"'),e.push(o),t=r+1}for(var a=0;a<n.length;a++)"."!==n[a]||r?r?r&&("["===n[a]?r++:"]"===n[a]&&r--,r||o(a,!1)):"["===n[a]?(o(a),r++):"]"===n[a]&&i():o(a);return t!==n.length&&o(n.length),r&&i(),e}(r),function(t){c.push(n.call(u,t))}),function n(t,r,i,o,u){var c=i[0];"length"===c&&a(r)&&(c="len");"len"===c&&E(r);if("*"===c&&a(r)){E(r);var f={},l=y(i);l.unshift(0);return f.length=n(t,r,["length"],function(){e(Object.keys(r),function(n){f[n]||(l[0]=n,f[n]=function n(t,r,i,o,u){var c=i[0];"length"===c&&a(r)&&(c="len");"len"===c&&E(r);if("*"===c&&a(r)){E(r);var f={},l=y(i);l.unshift(0);return f.length=n(t,r,["length"],function(){e(Object.keys(r),function(e){f[e]||(l[0]=e,f[e]=n(t,r,l,o,u))})},u),function(){e(Object.keys(f),function(n){f[n](),delete f[n]})}}t+=t?" -> "+c:c;var s=Object.getOwnPropertyDescriptor(r,c);var d;if(void 0===s)console.warn(t+" not defined in data source and is initiated as {}. \n\tOriginal: "+i),d=b(r,c);else if(g(s))d=s;else if(s){var p=r[c];delete r[c],d=b(r,c,p)}if(i.length>1){var h=y(i);return n(t,r[c],h,o,u)}return d.get(o,u)}(t,r,l,o,u))})},u),function(){e(Object.keys(f),function(n){f[n](),delete f[n]})}}t+=t?" -> "+c:c;var s=Object.getOwnPropertyDescriptor(r,c);var d;if(void 0===s)console.warn(t+" not defined in data source and is initiated as {}. \n\tOriginal: "+i),d=b(r,c);else if(g(s))d=s;else if(s){var p=r[c];delete r[c],d=b(r,c,p)}if(i.length>1){var h=y(i);return n(t,r[c],h,o,u)}return d.get(o,u)}("",t,c,function(){var n=Array.prototype.slice.call(arguments);return i.apply(u,n)},function(){var n=Array.prototype.slice.call(arguments);return o.apply(u,n)})}function v(n,t,r,i,o){var u=r[0];if(u==="length"&&a(t)){u="len"}if(u==="len"){E(t)}if(u==="*"&&a(t)){E(t);var c={};var f=y(r);f.unshift(0);var l=function(){var r;e(Object.keys(t),function(e){if(c[e]){return}f[0]=e;c[e]=v(n,t,f,i,o)})};c.length=v(n,t,["length"],l,o);return function(){e(Object.keys(c),function(n){c[n]();delete c[n]})}}n=n+(n?" -> "+u:u);var s=Object.getOwnPropertyDescriptor(t,u);var d;if(typeof s==="undefined"){console.warn(n+" not defined in data source and is initiated as {}. \n\tOriginal: "+r);d=b(t,u)}else if(g(s)){d=s}else if(s){var p=t[u];delete t[u];d=b(t,u,p)}if(r.length>1){var h=y(r);return v(n,t[u],h,i,o)}else{return d.get(i,o)}}function y(n){var t=[];return e(n,function(n,e){e&&t.push(n)}),t}function g(n){return n&&n.get&&2===n.get.length&&n.set&&1===n.set.length}var m=f(23),x=f(23);function b(n,t,e,r){e=arguments.length>2?e:{},r=r||{};var i,o=new j,a=function(n,t){o.each(function(e){e.set(n,t)})};return E(e),Object.defineProperty(n,t,i={enumerable:!p(r,"enumerable")||r.enumerable,configurable:!p(r,"configurable")||r.configurable,get:function(n,t){if(n&&t){var r=o.find(function(e){return e.set===n&&e.del===t});return!r&&(r=o.push({set:n,del:t})),d(a,e),r.drop}return e},set:function(r){var i=this;if(void 0===r&&(delete n[t],o.each(function(n){n.drop(),Function.prototype.call.call(n.del,i)}),O(e)),r===x)d(a,e,e,{obj:n,prop:t});else{if(r!==m){if(r!==e){d(a,r,e,{obj:n,prop:t});var u=e;E(e=r),O(u)}return e}o.each(function(n){n.drop(),Function.prototype.call.call(n.del,i)}),O(e)}}}),i}function O(n){var t;(t=n)&&"object"==typeof t&&(a(n)&&p(n,"len")&&(n.len=m),e(Object.keys(n),function(t){g(Object.getOwnPropertyDescriptor(n,t))&&(n[t]=m)}))}var w={};function E(n){n&&a(n)&&!p(n,"len")&&(b(n,"len",n.length,{enumerable:!1}),e(Object.getOwnPropertyNames(w),function(t){var e=w[t];l(n,t,e)}))}function j(){this.first=null,this.last=null,this.length=0}e(Object.getOwnPropertyNames(Array.prototype),function(n){var t=Array.prototype[n];"function"==typeof t&&(w[n]=function(){var n=Array.prototype.slice.call(arguments),e=t.apply(this,n);return this.len=this.length,this.len=x,e})}),j.prototype={push:function(n){var t=new function(n,t){var e=this;Object.assign(e,n),e.prev=null,e.next=null,e.drop=function(){!function(n,t){var e=!1;if(n.prev&&n.prev.next===n&&(n.prev.next=n.next,e=!0),n.next&&n.next.prev===n&&(n.next.prev=n.prev,e=!0),!(e||1===t.length&&t.first===n&&t.last===n))return;t.first===n&&(t.first=n.next),t.last===n&&(t.last=n.prev),t.length--}(e,t)}}(n,this);return t.prev=this.last,this.last&&(this.last.next=t),this.last=t,!this.first&&(this.first=t),this.length++,t},each:function(n){for(var t=this.first;t;)n(t),t=t.next},find:function(n){for(var t=this.first,e=0,r=null;t&&!r;){var i=n(t,e);e++,i&&(r=t),t=t.next}return r}};var N=document.createElement("template");function C(n,t,r,i){for(var o,a,u=!1,c=[],f=[],l=[],s=n.length-1;s>-1;s--){var d=!0,p=n[s];if(u&&(d=!1),p instanceof Comment&&0===p.textContent.trim().toLowerCase().indexOf("in:")&&(d=u=!0,o=p),p instanceof Comment&&0===p.textContent.trim().toLowerCase().indexOf("key:")&&(d=!0,a=p),p instanceof Comment&&0===p.textContent.trim().toLowerCase().indexOf("foreach:")){d=!0,u=!1;var h=function(e,o,a,u){c.push(k(e,o,a,u,n,t,r,i))}.bind(null,p,o,a,l);f.splice(f.length-1,0,h),o=a=void 0,l=[]}d?f.push(function(n){e(A(n,t,r,i),function(n){c.push(n)})}.bind(null,p)):(n.splice(s,1),p.parentNode&&p.parentNode.removeChild(p),l.unshift(p))}for(s=f.length-1;s>-1;s--)f[s]();return c}function k(a,u,c,f,l,s,d,p){var v,y,g,m=[],x={},b=a.textContent.trim().slice(8).trim(),O=u.textContent.trim().slice(3).trim(),w=O+".len",E=n.call(a,b),j=a;if(c){var N="("+c.textContent.trim().slice(4).trim()+")";j=c}return p||(p=function(n,t,e){return function(){}}),function t(){if(v){var e=m.indexOf(v);m.splice(e,1)}m.push(v=h.call(u,s,w,k,t));y=n.call(u,O,s);k()}(),function(){e(Object.keys(x),function(n){x[n].unlink()}),e(m,function(n){n()})};function k(a,c){if(a===c){if(a<2&&void 0!=c)return;if(g){var h=!0;if(e(y,function(n,t){g[t]!==n&&(h=!1)}),h)return}g=t(y)}var v={};e(y,function(a,c,l){var h=c;if(N&&(r(h=n.call(u,N,a))&&(h=h(a,c,l)),!i(h)&&!o(h)))throw new Error("Keys can only be Strings or Numbers but got "+typeof h+" while using "+N+" to obtain a key from "+O+"["+c+"]");var y=x[h]=x[h]||function(n,r){L.push([]);var i=(a=f,t(a).map(function(n){return n.cloneNode(!0)})),o=[];var a;e(C(i,s,d,function(n,t,e){var o=p(n,t,e);return i.index=r,Object.defineProperty(n,E,{configurable:!0,get:function(){return i.index}}),function(){o(),delete n[E]}}),function(n){o.push(n)});var u=function(){e(o,function(n){n!==u&&n()}),n.splice(n.indexOf(u),1)};return n.push(u),o.push(u),T(i,o,s,d),i}(m,c);if(y.key=h,y.index=c,v[h])throw new Error("Keys must be unique but found duplicate key at: "+O+"["+c+"]");v[h]=y}),e(Object.keys(x),function(n){v[n]||(x[n].detach(),x[n].unlink(),P(x[n]),delete x[n])});for(var b=0,w=[j];b<y.length;b++){var k=y[b],A=(b-1>=0&&y[b-1],N?n.call(u,N,k):b);A=r(A)?A(k,b,y):A;var D=w[w.length-1],q=l.indexOf(D),M=l[q+1],S=x[A];if(M[E]!==b){M&&M.parentElement&&S.appendTo(M.parentElement,M),P(S);var F=l.indexOf(D)+1,I=S.slice();I.unshift(0),I.unshift(F),Array.prototype.splice.apply(l,I)}w=S}}function P(n){var t=l.indexOf(n[0]);t>-1&&l.splice(t,n.length)}}function P(n,t,r){Object.defineProperty(n,r,{configurable:!0,get:function(){return t},set:function(n){var r=Object.keys(t),i=Object.keys(n);e(r,function(n){-1===i.indexOf(n)&&(g(Object.getOwnPropertyDescriptor(t,n))?t[n]=void 0:delete t[n])}),e(i,function(e){t[e]=n[e]})}})}f(u(32,48));function A(n,r,i,o){var a=[];if(P(n,r,i),a.push(function(){delete n[i]}),o){var u=o(n,r,i);a.push(u)}if(n instanceof CharacterData){var c=M(n,n,i);c&&a.push(c)}else{e(t(n.attributes),function(t){var e=M(t,n,i);e&&a.push(e)}),e(C(t(n.childNodes),r,i,o),function(n){a.push(n)})}return a}function T(n,t,r,o){var a=[L.pop(),q.pop()];return P(n,r,o),l(n,"appendTo",function(n,t){(function n(t,r){if(!t)return;if(i(t))return n.call(this,document.querySelector(t),r);if(i(t))return n.call(this,t,t.querySelector(r));var o=t;e(this,r?function(n){o.insertBefore(n,r)}:function(n){o.appendChild(n)});return this}).call(this,n,t),e(a[0],function(n){n()})}),l(n,"detach",function(){(function(){return e(this,function(n){var t=n.parentElement;t&&t.removeChild(n)}),this}).call(this),e(a[1],function(n){n()})}),l(n,"unlink",function(){for(var n=0;n<t.length;n++)t[n]();delete onAttachCallbacks}),n}function D(){L.push([]),q.push([])}var L=[];var q=[];function M(t,r,i){var o=[];e(t.textContent.split("{:"),function(n,t){e(n.split(":}"),function(n,e){o.push({text:n,code:!e&&!!t})})}),e(o,function(n,t){if(n.text.length>2&&"|"===n.text[0]&&"{"===n.text[1]){var e=n.text.indexOf("}|"),r=n.text.slice(1,e+1);n.text=n.text.slice(e+2),o[t-1].watching=r.split(",").map(function(n){return n.trim().slice(1,-1)}).filter(function(n){return n})}});var u=!0;if(e(o=o.filter(function(n){return n.text||n.code}),function(n){u&&n.code&&(u=!1)}),!u){var c,f,l=!0;if(e(o,function(n){l&&(n.code||(n.code||n.text.trim())&&(l=!1))}),l&&(o=o.filter(function(n){return n.code})),t instanceof Text&&(c=document.createTextNode),t instanceof Comment&&(c=document.createComment),c){var s=function(){var n=[];e(o,function(t){n.push(t.domNode=c.call(document,t.text))}),t.replaceWith.apply(t,n)};s(),f=function(){t.parentNode&&(s(),S(t,o))},L.length&&L[L.length-1].push(f),function(n){q.length&&q[q.length-1].push(n)}(function(){e(o,function(n){n.domNode.parentNode&&n.domNode.parentNode.removeChild(n.domNode)})})}var d=[];return e(o,function(u){if(u.code)if(u.watching){function c(e,i){var c=n.call(r,u.text);c===u.val||function(n,t){if(n instanceof Element&&t instanceof Element)return n.isEqualNode(t);if(!a(n)||!a(t))return!1;if(n.length!==t.length)return!1;for(var e=0;e<n.length;e++){if(!(n[e]instanceof Element))return!1;if(!n[e].isEqualNode(t[e])&&n[e]!==t[e])return!1}return!0}(c,u.val)||(u.val&&u.val.detach&&u.val.detach(),u.val=c,S(t,o))}e(u.watching,function(n){var t;!function e(){if(t){var o=d.indexOf(t);d.splice(o)}d.push(t=h.call(r,r[i],n.trim(),c,e))}()})}else u.val=n.call(r,u.text);else u.val=u.text}),S(t,o),d.length?function(){e(d,function(n){n()})}:void 0}}function S(n,r){var i="";if(1===r.length&&n instanceof Attr){i=r[0].val;var o=n.ownerElement;if("data-"!==n.name.slice(0,5))return n.textContent=i;var a=n.name.slice(5);a in o&&(o[a]=i)}else n instanceof Text||n instanceof Comment?e(r,function(n){if(n.val&&n.val.appendTo&&n.val.detach&&n.val.length){var e=t(n.val),r=document.createComment(n.domNode.textContent);e.push(r),n.domNode.replaceWith.apply(n.domNode,e),n.domNode=r,n.val.appendTo()}else n.domNode.textContent=n.val}):(e(r,function(n){i+=n.val}),n.textContent=i)}var F=function(n,e,r){return function n(e,r,o){if(i(e))return N.innerHTML=e.trim(),n(N.content.childNodes,r,o);if(e instanceof NodeList||a(e)&&e.reduce(function(n,t){return n&&t instanceof Node},!0)){D();var u=t(e);return T(u,C(u,r,o),r,o)}return e instanceof Node?(D(),T([e],A(e,r,o),r,o)):void 0}(n,e=e||{},r=r||"app")},I=function(n){var t=n+"Promise";return d[t]?d[t]:d[t]=new Promise(function(t){d[n]=t})},K=function(n,t){"function"==typeof t&&I(n).then(t)};return l(F,"on",{}),l(F,"watch",h),s(F.on,"asyncend",I.bind(this,"asyncEnd"),K.bind(this,"asyncEnd")),s(F.on,"renderend",I.bind(this,"renderEnd"),K.bind(this,"renderEnd")),l(F,"random",{}),l(F.random,"number",u),l(F.random,"string",f),F}(function(s,sv,t){void 0===t&&(t=!1);try{if(sv)with(sv)return eval(s);return eval(s)}catch(o3o){if(t)throw o3o;return console.error("failed to evaluate expression ["+s+"]",this,o3o),""}});"undefined"!=typeof module&&(module.exports=proxymity);