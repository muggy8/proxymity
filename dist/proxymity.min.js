var proxymity=function(n){function e(n){return Array.prototype.slice.call(n||[])}function t(n,e){return n&&o(n.length)&&Array.prototype.forEach.call(n,e)}function r(n){return"function"==typeof n}function i(n){return"string"==typeof n}function o(n){return"number"==typeof n&&!isNaN(n)}function a(n){return Array.isArray(n)}function u(n,e){var t,r,i;return void 0===e||n>e?(r=n,t=e||0):(t=n,r=e),i=r-t,Math.round(Math.random()*(i+.9998)-.4999)+t}var c="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789_";function f(n){n=n||16;for(var e=c[u(51)],t=1;t<n;t++)e+=c[u(62)];return e}function l(n,e,t){return Object.defineProperty(n,e,{value:t}),t}function s(n,e,t,r){var i={get:t};return r&&(i.set=r),Object.defineProperty(n,e,i)}function d(n,e){if(n instanceof Element&&e instanceof Element)return n.isEqualNode(e);if(!a(n)||!a(e))return!1;if(n.length!==e.length)return!1;for(var t=0;t<n.length;t++)if(!(n[t]instanceof Element&&e[t]instanceof Element&&n[t].isEqualNode(e[t]))&&n[t]!==e[t])return!1;return!0}var p=function(){var n=f(u(32,48)),e=!1,r=[],i=0,o={};function a(t){var o=Array.prototype.slice.call(arguments,1);e||(window.postMessage(n,"*"),e=!0,i++),r.some(function(n){return n.fn===t&&(n.args=o,!0)})||r.push({fn:t,args:o})}return window.addEventListener("message",function(c){if(c.data===n){c.stopPropagation();var l=r;if(n=f(u(32,48)),e=!1,r=[],i>10)return console.warn("UI has been updated continiously for 10 or more update cycles and has thus been halted. You might have updated or watched a property that is already being watched during an render loop. The following user scripts are likely the cause of the continious updates",JSON.stringify(Object.keys(o),null,"\t")),i=0,void(o={});t(l,function(n){n.args=n.args.map(function(n){return m(n)?n.get():n}),n.fn.apply(window,n.args)}),a.asyncEnd&&(a.asyncEnd(),delete a.asyncEnd,delete a.asyncEndPromise),!e&&a.renderEnd&&(a.renderEnd(),delete a.renderEnd,delete a.renderEndPromise),r.length||(i=0,o={})}}),a.registerCaller=function(n){o[n]=!0},a}();function h(n,e){return Object.prototype.hasOwnProperty.call(n,e)}function v(e,r,i,o){o=o||function(){};var u=this||{},c=[];return t(function(n){n=n||"";var e=0,t=[],r=0;function i(){throw new Error("Potential Syntax Error within code: \n"+n)}function o(r,i){void 0===i&&(i=!0);var o=n.substring(e,r);if(!o)return e=r+1;i&&(o='"'+o+'"'),t.push(o),e=r+1}for(var a=0;a<n.length;a++)"."!==n[a]||r?r?r&&("["===n[a]?r++:"]"===n[a]&&r--,r||o(a,!1)):"["===n[a]?(o(a),r++):"]"===n[a]&&i():o(a);return e!==n.length&&o(n.length),r&&i(),t}(r),function(e){c.push(n.call(u,e))}),function n(e,r,i,o,u){var c=i[0];"length"===c&&a(r)&&(c="len");"len"===c&&C(r);if("*"===c&&a(r)){C(r);var f={},l=y(i);l.unshift(0);return f.length=n(e,r,["length"],function(){t(Object.keys(r),function(n){f[n]||(l[0]=n,f[n]=function n(e,r,i,o,u){var c=i[0];"length"===c&&a(r)&&(c="len");"len"===c&&C(r);if("*"===c&&a(r)){C(r);var f={},l=y(i);l.unshift(0);return f.length=n(e,r,["length"],function(){t(Object.keys(r),function(t){f[t]||(l[0]=t,f[t]=n(e,r,l,o,u))})},u),function(){t(Object.keys(f),function(n){f[n](),delete f[n]})}}e+=e?" -> "+c:c;var s=Object.getOwnPropertyDescriptor(r,c);var d;if(void 0===s)console.warn(e+" not defined in data source and is initiated as {}. \n\tOriginal: "+i),d=O(r,c);else if(m(s))d=s;else if(s){var p=r[c];delete r[c],d=O(r,c,p)}if(i.length>1){var h=y(i);return n(e,r[c],h,o,u)}return d.get(o,u)}(e,r,l,o,u))})},u),function(){t(Object.keys(f),function(n){f[n](),delete f[n]})}}e+=e?" -> "+c:c;var s=Object.getOwnPropertyDescriptor(r,c);var d;if(void 0===s)console.warn(e+" not defined in data source and is initiated as {}. \n\tOriginal: "+i),d=O(r,c);else if(m(s))d=s;else if(s){var p=r[c];delete r[c],d=O(r,c,p)}if(i.length>1){var h=y(i);return n(e,r[c],h,o,u)}return d.get(o,u)}("",e,c,function(){var n=Array.prototype.slice.call(arguments);return i.apply(u,n)},function(){var n=Array.prototype.slice.call(arguments);return o.apply(u,n)})}function g(n,e,r,i,o){var u=r[0];if(u==="length"&&a(e)){u="len"}if(u==="len"){C(e)}if(u==="*"&&a(e)){C(e);var c={};var f=y(r);f.unshift(0);var l=function(){var r;t(Object.keys(e),function(t){if(c[t]){return}f[0]=t;c[t]=g(n,e,f,i,o)})};c.length=g(n,e,["length"],l,o);return function(){t(Object.keys(c),function(n){c[n]();delete c[n]})}}n=n+(n?" -> "+u:u);var s=Object.getOwnPropertyDescriptor(e,u);var d;if(typeof s==="undefined"){console.warn(n+" not defined in data source and is initiated as {}. \n\tOriginal: "+r);d=O(e,u)}else if(m(s)){d=s}else if(s){var p=e[u];delete e[u];d=O(e,u,p)}if(r.length>1){var h=y(r);return g(n,e[u],h,i,o)}else{return d.get(i,o)}}function y(n){var e=[];return t(n,function(n,t){t&&e.push(n)}),e}function m(n){return n&&n.get&&2===n.get.length&&n.set&&1===n.set.length}var b=f(23),x=f(23);function O(n,e,t,r){t=arguments.length>2?t:{},r=r||{};var i,o=new N,a=function(n,e){o.each(function(t){t.set(n,e)})};return C(t),Object.defineProperty(n,e,i={enumerable:!h(r,"enumerable")||r.enumerable,configurable:!h(r,"configurable")||r.configurable,get:function(n,e){if(n&&e){var r=o.find(function(t){return t.set===n&&t.del===e});return!r&&(r=o.push({set:n,del:e})),p(a,t),K.currentTaskSource&&p.registerCaller(K.currentTaskSource),r.drop}return t},set:function(r){var i=this;if(void 0===r&&(delete n[e],o.each(function(n){n.drop(),Function.prototype.call.call(n.del,i)}),w(t)),r===x)p(a,t,t,{obj:n,prop:e}),K.currentTaskSource&&p.registerCaller(K.currentTaskSource);else{if(r!==b){if(r!==t){p(a,r,t,{obj:n,prop:e}),K.currentTaskSource&&p.registerCaller(K.currentTaskSource);var u=t;C(t=r),w(u)}return t}o.each(function(n){n.drop(),Function.prototype.call.call(n.del,i)}),w(t)}}}),i}function w(n){var e;(e=n)&&"object"==typeof e&&(a(n)&&h(n,"len")&&(n.len=b),t(Object.keys(n),function(e){m(Object.getOwnPropertyDescriptor(n,e))&&(n[e]=b)}))}var k={};function C(n){n&&a(n)&&!h(n,"len")&&(O(n,"len",n.length,{enumerable:!1}),t(Object.getOwnPropertyNames(k),function(e){var t=k[e];l(n,e,t)}))}function N(){this.first=null,this.last=null,this.length=0}t(Object.getOwnPropertyNames(Array.prototype),function(n){var t=Array.prototype[n];"function"==typeof t&&(k[n]=function(){var n=Array.prototype.slice.call(arguments),r=e(this),i=t.apply(this,n);return d(r,this)?i:(this.len=this.length,this.len=x,i)})}),N.prototype={push:function(n){var e=new function(n,e){var t=this;Object.assign(t,n),t.prev=null,t.next=null,t.drop=function(){!function(n,e){var t=!1;if(n.prev&&n.prev.next===n&&(n.prev.next=n.next,t=!0),n.next&&n.next.prev===n&&(n.next.prev=n.prev,t=!0),!(t||1===e.length&&e.first===n&&e.last===n))return;e.first===n&&(e.first=n.next),e.last===n&&(e.last=n.prev),e.length--}(t,e)}}(n,this);return e.prev=this.last,this.last&&(this.last.next=e),this.last=e,!this.first&&(this.first=e),this.length++,e},each:function(n){for(var e=this.first;e;)n(e),e=e.next},find:function(n){for(var e=this.first,t=0,r=null;e&&!r;){var i=n(e,t);t++,i&&(r=e),e=e.next}return r}};var j=document.createElement("template");function E(n,e,r,i){for(var o,a,u=!1,c=[],f=[],l=[],s=n.length-1;s>-1;s--){var d=!0,p=n[s];if(u&&(d=!1),p instanceof Comment&&0===p.textContent.trim().toLowerCase().indexOf("in:")&&(d=u=!0,o=p),p instanceof Comment&&0===p.textContent.trim().toLowerCase().indexOf("key:")&&(d=!0,a=p),p instanceof Comment&&0===p.textContent.trim().toLowerCase().indexOf("foreach:")){d=!0,u=!1;var h=function(t,o,a,u){c.push(T(t,o,a,u,n,e,r,i))}.bind(null,p,o,a,l);f.splice(f.length-1,0,h),o=a=void 0,l=[]}d?f.push(function(n){t(S(n,e,r,i),function(n){c.push(n)})}.bind(null,p)):(n.splice(s,1),p.parentNode&&p.parentNode.removeChild(p),l.unshift(p))}for(s=f.length-1;s>-1;s--)f[s]();return c}function T(a,u,c,f,l,s,d,p){var h,g,y=[],m={},b=a.textContent.trim().slice(8).trim(),x=u.textContent.trim().slice(3).trim(),O=x+".len",w=n.call(a,b),k=a;if(c){var C="("+c.textContent.trim().slice(4).trim()+")";k=c}return p||(p=function(n,e,t){return function(){}}),function e(){if(h){var t=y.indexOf(h);y.splice(t,1)}y.push(h=v.call(u,s,O,N,e));g=n.call(u,x,s);N()}(),function(){t(Object.keys(m),function(n){m[n].unlink()}),t(y,function(n){n()})};function N(a,c){var h={};t(g,function(a,c,l){var v=c;if(C&&(r(v=n.call(u,C,a))&&(v=v(a,c,l)),!i(v)&&!o(v)))throw new Error("Keys can only be Strings or Numbers but got "+typeof v+" while using "+C+" to obtain a key from "+x+"["+c+"]");var g=m[v]=m[v]||function(n,r){D();var i=(a=f,e(a).map(function(n){return n.cloneNode(!0)})),o=[];var a;t(E(i,s,d,function(n,e,t){var o=p(n,e,t);return i.index=r,Object.defineProperty(n,w,{configurable:!0,get:function(){return i.index}}),function(){o(),delete n[w]}}),function(n){o.push(n)});var u=function(){t(o,function(n){n!==u&&n()}),n.splice(n.indexOf(u),1)};return n.push(u),o.push(u),A(i,o,s,d),i}(y,c);if(g.key=v,g.index=c,h[v])throw new Error("Keys must be unique but found duplicate key at: "+x+"["+c+"]");h[v]=g}),t(Object.keys(m),function(n){h[n]||(m[n].detach(),m[n].unlink(),j(m[n]),delete m[n])});for(var v=0,b=[k];v<g.length;v++){var O=g[v],N=(v-1>=0&&g[v-1],C?n.call(u,C,O):v);N=r(N)?N(O,v,g):N;var T=b[b.length-1],P=l.indexOf(T),S=l[P+1],L=m[N];if(S[w]!==v){S&&S.parentElement&&L.appendTo(S.parentElement,S),j(L);var q=l.indexOf(T)+1,M=L.slice();M.unshift(0),M.unshift(q),Array.prototype.splice.apply(l,M)}b=L}}function j(n){var e=l.indexOf(n[0]);e>-1&&l.splice(e,n.length)}}function P(n,e,r){Object.defineProperty(n,r,{configurable:!0,get:function(){return e},set:function(n){var r=Object.keys(e),i=Object.keys(n);t(r,function(n){-1===i.indexOf(n)&&(m(Object.getOwnPropertyDescriptor(e,n))?e[n]=void 0:delete e[n])}),t(i,function(t){e[t]=n[t]})}})}f(u(32,48));function S(n,r,i,o){var a=[];if(P(n,r,i),a.push(function(){delete n[i]}),o){var u=o(n,r,i);a.push(u)}if(n instanceof CharacterData){var c=K(n,n,i);c&&a.push(c)}else{t(e(n.attributes),function(e){var t=K(e,n,i);t&&a.push(t)}),t(E(e(n.childNodes),r,i,o),function(n){a.push(n)})}return a}function A(n,e,r,o){var a=[q.pop(),M.pop(),F.pop()],u=a[0],c=a[1],f=a[2];function s(n){return function(e){return L(n,e)}}return P(n,r,o),l(n,"appendTo",function(n,e){(function n(e,r){if(!e)return;if(i(e))return n.call(this,document.querySelector(e),r);if(i(e))return n.call(this,e,e.querySelector(r));var o=e;t(this,r?function(n){o.insertBefore(n,r)}:function(n){o.appendChild(n)});return this}).call(this,n,e),u.each(function(n){n.fn()})}),l(n,"detach",function(){(function(){return t(this,function(n){var e=n.parentElement;e&&e.removeChild(n)}),this}).call(this),c.each(function(n){n.fn()})}),l(n,"unlink",function(){for(var n=0;n<e.length;n++)e[n]();delete onAttachCallbacks,f.each(function(n){n.fn()})}),l(n,"when",{append:s(u),detach:s(c),unlink:s(f)}),n}function D(){q.push(new N),M.push(new N),F.push(new N)}function L(n,e){return n.push({fn:e}).drop}var q=[];var M=[];var F=[];function K(e,r,i){var o=e.textContent,a=[];t(o.split("{:"),function(n,e){t(n.split(":}"),function(n,t){a.push({text:n,code:!t&&!!e})})}),t(a,function(n,e){if(n.text.length>2&&"|"===n.text[0]&&"{"===n.text[1]){var t=n.text.indexOf("}|"),r=n.text.slice(1,t+1);n.text=n.text.slice(t+2),a[e-1].watching=r.split(",").map(function(n){return n.trim().slice(1,-1)}).filter(function(n){return n})}});var u=!0;if(t(a=a.filter(function(n){return n.text||n.code}),function(n){u&&n.code&&(u=!1)}),!u){var c,f,l=!0;if(t(a,function(n){l&&(n.code||(n.code||n.text.trim())&&(l=!1))}),l&&(a=a.filter(function(n){return n.code})),e instanceof Text&&(c=document.createTextNode),e instanceof Comment&&(c=document.createComment),c){var s=!r.parentNode,p=function(){var n=[];t(a,function(e){n.push(e.domNode=c.call(document,e.text))}),e.replaceWith.apply(e,n)};p(),f=function(){e.parentNode&&(p(),W(e,a))},q.length&&L(q[q.length-1],f),function(n){M.length&&L(M[M.length-1],n)}(function(){t(a,function(n){s&&n.domNode.parentNode&&n.domNode.parentNode.removeChild(n.domNode)})})}var h=[];return t(a,function(u){if(u.code)if(u.watching){function c(t,i){K.currentTaskSource=o;var c=n.call(r,u.text);K.currentTaskSource=void 0,c===u.val||d(c,u.val)||(u.val&&u.val.detach&&u.val.detach(),u.val=c,W(e,a))}t(u.watching,function(n){var e;!function t(){if(e){var o=h.indexOf(e);h.splice(o)}h.push(e=v.call(r,r[i],n.trim(),c,t))}()})}else K.currentTaskSource=o,u.val=n.call(r,u.text),K.currentTaskSource=void 0;else u.val=u.text}),W(e,a),h.length?function(){t(h,function(n){n()})}:void 0}}function W(n,r){var i="";if(1===r.length&&n instanceof Attr){i=r[0].val;var o=n.ownerElement;if("data-"!==n.name.slice(0,5))return n.textContent=i;var a=n.name.slice(5);a in o&&(o[a]=i)}else n instanceof Text||n instanceof Comment?t(r,function(n){if(n.val&&n.val.appendTo&&n.val.detach&&n.val.length){var t=e(n.val),r=document.createComment(n.domNode.textContent);t.push(r),n.domNode.replaceWith.apply(n.domNode,t),n.domNode=r,n.val.appendTo()}else n.domNode.textContent=n.val}):(t(r,function(n){i+=n.val}),n.textContent=i)}K.currentTaskSource=void 0;var B=function(n,t,r){return function n(t,r,o){if(i(t))return j.innerHTML=t.trim(),n(j.content.childNodes,r,o);if(t instanceof NodeList||a(t)&&t.reduce(function(n,e){return n&&e instanceof Node},!0)){D();var u=e(t);return A(u,E(u,r,o),r,o)}return t instanceof Node?(D(),A([t],S(t,r,o),r,o)):void 0}(n,t=t||{},r=r||"app")},H=function(n){var e=n+"Promise";return p[e]?p[e]:p[e]=new Promise(function(e){p[n]=e})},I=function(n,e){"function"==typeof e&&H(n).then(e)};return l(B,"on",{}),l(B,"watch",v),s(B.on,"asyncend",H.bind(this,"asyncEnd"),I.bind(this,"asyncEnd")),s(B.on,"renderend",H.bind(this,"renderEnd"),I.bind(this,"renderEnd")),l(B,"random",{}),l(B.random,"number",u),l(B.random,"string",f),B}(function(s,sv,t){void 0===t&&(t=!1);try{if(sv)with(sv)return eval(s);return eval(s)}catch(o3o){if(t)throw o3o;return console.error("failed to evaluate expression ["+s+"]",this,o3o),""}});"undefined"!=typeof module&&(module.exports=proxymity);